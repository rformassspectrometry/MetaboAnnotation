<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The matchValues method matches elements from query with those in target
using different matching approaches depending on parameter param.
Generally, query is expected to contain MS experimental values
(m/z and possibly retention time) while target reference values. query
and target can be numeric, a two dimensional array (such as a
data.frame, matrix or DataFrame), a SummarizedExperiment
or a QFeatures, target can in addition be a Spectra() object.
For SummarizedExperiment, the information for the matching is expected
to be in the object's rowData. For QFeatures matching is performed
for values present in the rowData of one of the object's assays (which
needs to be specified with the assayQuery parameter - if a QFeatures
is used as target the name of the assay needs to be specified with
parameter assayTarget). If target is a Spectra matching is performed
against spectra variables of this object and the respective variable names
need to be specified e.g. with mzColname and/or rtColname.
matchMz is an alias for matchValues to allow backward compatibility.
Available param objects and corresponding matching approaches are:
ValueParam: generic matching between values in query and target given
acceptable differences expressed in ppm and tolerance. If query or
target are not numeric, parameter valueColname has to be used to
specify the name of the column that contains the values to be matched.
The function returns a Matched() object.
MzParam: match query m/z values against reference compounds for which
also m/z are known. Matching is performed similarly to the ValueParam
above. If query or target are not numeric, the column name containing
the values to be compared must be defined with matchValues' parameter
mzColname, which defaults to &quot;mz&quot;. MzParam parameters tolerance
and ppm allow to define the maximal acceptable (constant or m/z relative)
difference between query and target m/z values.
MzRtParam: match m/z and retention time values between query and
target. Parameters mzColname and rtColname of the matchValues
function allow to define the columns in query and target containing
these values (defaulting to c(&quot;mz&quot;, &quot;mz&quot;) and c(&quot;rt&quot;, &quot;rt&quot;),
respectively). MzRtParam parameters tolerance and
ppm have the same meaning as in MzParam; MzRtParam parameter
toleranceRt allows to specify the maximal acceptable difference between
query and target retention time values.
Mass2MzParam: match m/z values against reference compounds for
which only the (exact) mass is known. Before matching, m/z values are
calculated from the compounds masses in the target table using the
adducts specified via Mass2MzParam adducts parameter (defaults to
adducts = &quot;[M+H]+&quot;). After conversion of adduct masses to m/z values,
matching is performed similarly to MzParam (i.e. the same parameters
ppm and tolerance can be used). If query is not numeric,
parameter mzColname of matchValues can be used to specify the column
containing the query's m/z values (defaults to &quot;mz&quot;). If target is a
is not numeric, parameter massColname can be used to define the
column containing the reference compound's masses (defaults to
&quot;exactmass&quot;).
Mass2MzRtParam: match m/z and retention time values against
reference compounds for which the (exact) mass and retention time are
known. Before matching, exact masses in target are converted to m/z
values as for Mass2MzParam. Matching is then performed similarly to
MzRtParam, i.e. m/z and retention times of entities are compared. With
matchValues' parameters mzColname, rtColname and massColname the
columns containing m/z values (in query), retention time values (in
query and target) and exact masses (in target) can be specified.
Mz2MassParam: input values for query and target are expected to be
m/z values but matching is performed on exact masses calculated from these
(based on the provided adduct definitions). In detail, m/z values in
query are first converted to masses with the mz2mass() function based
on the adducts defined with queryAdducts (defaults to &quot;[M+H]+&quot;). The
same is done for m/z values in target (adducts can be defined with
targetAdducts which defaults to &quot;[M-H-]&quot;). Matching is then performed on these converted values similarly to ValueParam. If queryortargetare not numeric, the column containing the m/z values can be specified withmatchValues' parameter mzColname(defaults to&quot;mz&quot;`).
Mz2MassRtParam: same as Mz2MassParam but with additional comparison of
retention times between query and target. Parameters rtColname and
mzColname of matchValues allow to specify which columns contain the
retention times and m/z values, respectively.

"><title>Matching of numeric values — ValueParam • MetaboAnnotation</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Matching of numeric values — ValueParam"><meta property="og:description" content="The matchValues method matches elements from query with those in target
using different matching approaches depending on parameter param.
Generally, query is expected to contain MS experimental values
(m/z and possibly retention time) while target reference values. query
and target can be numeric, a two dimensional array (such as a
data.frame, matrix or DataFrame), a SummarizedExperiment
or a QFeatures, target can in addition be a Spectra() object.
For SummarizedExperiment, the information for the matching is expected
to be in the object's rowData. For QFeatures matching is performed
for values present in the rowData of one of the object's assays (which
needs to be specified with the assayQuery parameter - if a QFeatures
is used as target the name of the assay needs to be specified with
parameter assayTarget). If target is a Spectra matching is performed
against spectra variables of this object and the respective variable names
need to be specified e.g. with mzColname and/or rtColname.
matchMz is an alias for matchValues to allow backward compatibility.
Available param objects and corresponding matching approaches are:
ValueParam: generic matching between values in query and target given
acceptable differences expressed in ppm and tolerance. If query or
target are not numeric, parameter valueColname has to be used to
specify the name of the column that contains the values to be matched.
The function returns a Matched() object.
MzParam: match query m/z values against reference compounds for which
also m/z are known. Matching is performed similarly to the ValueParam
above. If query or target are not numeric, the column name containing
the values to be compared must be defined with matchValues' parameter
mzColname, which defaults to &quot;mz&quot;. MzParam parameters tolerance
and ppm allow to define the maximal acceptable (constant or m/z relative)
difference between query and target m/z values.
MzRtParam: match m/z and retention time values between query and
target. Parameters mzColname and rtColname of the matchValues
function allow to define the columns in query and target containing
these values (defaulting to c(&quot;mz&quot;, &quot;mz&quot;) and c(&quot;rt&quot;, &quot;rt&quot;),
respectively). MzRtParam parameters tolerance and
ppm have the same meaning as in MzParam; MzRtParam parameter
toleranceRt allows to specify the maximal acceptable difference between
query and target retention time values.
Mass2MzParam: match m/z values against reference compounds for
which only the (exact) mass is known. Before matching, m/z values are
calculated from the compounds masses in the target table using the
adducts specified via Mass2MzParam adducts parameter (defaults to
adducts = &quot;[M+H]+&quot;). After conversion of adduct masses to m/z values,
matching is performed similarly to MzParam (i.e. the same parameters
ppm and tolerance can be used). If query is not numeric,
parameter mzColname of matchValues can be used to specify the column
containing the query's m/z values (defaults to &quot;mz&quot;). If target is a
is not numeric, parameter massColname can be used to define the
column containing the reference compound's masses (defaults to
&quot;exactmass&quot;).
Mass2MzRtParam: match m/z and retention time values against
reference compounds for which the (exact) mass and retention time are
known. Before matching, exact masses in target are converted to m/z
values as for Mass2MzParam. Matching is then performed similarly to
MzRtParam, i.e. m/z and retention times of entities are compared. With
matchValues' parameters mzColname, rtColname and massColname the
columns containing m/z values (in query), retention time values (in
query and target) and exact masses (in target) can be specified.
Mz2MassParam: input values for query and target are expected to be
m/z values but matching is performed on exact masses calculated from these
(based on the provided adduct definitions). In detail, m/z values in
query are first converted to masses with the mz2mass() function based
on the adducts defined with queryAdducts (defaults to &quot;[M+H]+&quot;). The
same is done for m/z values in target (adducts can be defined with
targetAdducts which defaults to &quot;[M-H-]&quot;). Matching is then performed on these converted values similarly to ValueParam. If queryortargetare not numeric, the column containing the m/z values can be specified withmatchValues' parameter mzColname(defaults to&quot;mz&quot;`).
Mz2MassRtParam: same as Mz2MassParam but with additional comparison of
retention times between query and target. Parameters rtColname and
mzColname of matchValues allow to specify which columns contain the
retention times and m/z values, respectively.

"><meta property="og:image" content="https://rformassspectrometry.github.io/MetaboAnnotation/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MetaboAnnotation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/MetaboAnnotation.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/RforMassSpectrometry/MetaboAnnotation/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Matching of numeric values</h1>
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/MetaboAnnotation/blob/HEAD/R/matchValues.R" class="external-link"><code>R/matchValues.R</code></a></small>
      <div class="d-none name"><code>matchValues.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>matchValues</code> method matches elements from <code>query</code> with those in <code>target</code>
using different matching approaches depending on parameter <code>param</code>.
Generally, <code>query</code> is expected to contain MS experimental values
(m/z and possibly retention time) while <code>target</code> reference values. <code>query</code>
and <code>target</code> can be <code>numeric</code>, a two dimensional array (such as a
<code>data.frame</code>, <code>matrix</code> or <code>DataFrame</code>), a <code>SummarizedExperiment</code>
or a <code>QFeatures</code>, <code>target</code> can in addition be a <code><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra()</a></code> object.
For <code>SummarizedExperiment</code>, the information for the matching is expected
to be in the object's <code>rowData</code>. For <code>QFeatures</code> matching is performed
for values present in the <code>rowData</code> of one of the object's assays (which
needs to be specified with the <code>assayQuery</code> parameter - if a <code>QFeatures</code>
is used as <code>target</code> the name of the assay needs to be specified with
parameter <code>assayTarget</code>). If <code>target</code> is a <code>Spectra</code> matching is performed
against spectra variables of this object and the respective variable names
need to be specified e.g. with <code>mzColname</code> and/or <code>rtColname</code>.
<code>matchMz</code> is an alias for <code>matchValues</code> to allow backward compatibility.</p>
<p>Available <code>param</code> objects and corresponding matching approaches are:</p><ul><li><p><code>ValueParam</code>: generic matching between values in <code>query</code> and <code>target</code> given
acceptable differences expressed in <code>ppm</code> and <code>tolerance</code>. If <code>query</code> or
<code>target</code> are not numeric, parameter <code>valueColname</code> has to be used to
specify the name of the column that contains the values to be matched.
The function returns a <code><a href="Matched.html">Matched()</a></code> object.</p></li>
<li><p><code>MzParam</code>: match query m/z values against reference compounds for which
also m/z are known. Matching is performed similarly to the <code>ValueParam</code>
above. If <code>query</code> or <code>target</code> are not numeric, the column name containing
the values to be compared must be defined with <code>matchValues</code>' parameter
<code>mzColname</code>, which defaults to <code>"mz"</code>. <code>MzParam</code> parameters <code>tolerance</code>
and <code>ppm</code> allow to define the maximal acceptable (constant or m/z relative)
difference between query and target m/z values.</p></li>
<li><p><code>MzRtParam</code>: match m/z <strong>and</strong> retention time values between <code>query</code> and
<code>target</code>. Parameters <code>mzColname</code> and <code>rtColname</code> of the <code>matchValues</code>
function allow to define the columns in <code>query</code> and <code>target</code> containing
these values (defaulting to <code>c("mz", "mz")</code> and <code>c("rt", "rt")</code>,
respectively). <code>MzRtParam</code> parameters <code>tolerance</code> and
<code>ppm</code> have the same meaning as in <code>MzParam</code>; <code>MzRtParam</code> parameter
<code>toleranceRt</code> allows to specify the maximal acceptable difference between
query and target retention time values.</p></li>
<li><p><code>Mass2MzParam</code>: match m/z values against reference compounds for
which only the (exact) mass is known. Before matching, m/z values are
calculated from the compounds masses in the <em>target</em> table using the
adducts specified via <code>Mass2MzParam</code> <code>adducts</code> parameter (defaults to
<code>adducts = "[M+H]+"</code>). After conversion of adduct masses to m/z values,
matching is performed similarly to <code>MzParam</code> (i.e. the same parameters
<code>ppm</code> and <code>tolerance</code> can be used). If <code>query</code> is not <code>numeric</code>,
parameter <code>mzColname</code> of <code>matchValues</code> can be used to specify the column
containing the query's m/z values (defaults to <code>"mz"</code>). If <code>target</code> is a
is not <code>numeric</code>, parameter <code>massColname</code> can be used to define the
column containing the reference compound's masses (defaults to
<code>"exactmass"</code>).</p></li>
<li><p><code>Mass2MzRtParam</code>: match m/z <strong>and</strong> retention time values against
reference compounds for which the (exact) mass <strong>and</strong> retention time are
known. Before matching, exact masses in <code>target</code> are converted to m/z
values as for <code>Mass2MzParam</code>. Matching is then performed similarly to
<code>MzRtParam</code>, i.e. m/z and retention times of entities are compared. With
<code>matchValues</code>' parameters <code>mzColname</code>, <code>rtColname</code> and <code>massColname</code> the
columns containing m/z values (in <code>query</code>), retention time values (in
<code>query</code> and <code>target</code>) and exact masses (in <code>target</code>) can be specified.</p></li>
<li><p><code>Mz2MassParam</code>: input values for <code>query</code> and <code>target</code> are expected to be
m/z values but matching is performed on exact masses calculated from these
(based on the provided adduct definitions). In detail, m/z values in
<code>query</code> are first converted to masses with the <code>mz2mass()</code> function based
on the adducts defined with <code>queryAdducts</code> (defaults to <code>"[M+H]+"</code>). The
same is done for m/z values in <code>target</code> (adducts can be defined with
<code>targetAdducts</code> which defaults to <code>"[M-H-]"). Matching is then performed on these converted values similarly to </code>ValueParam<code>. If </code>query<code>or</code>target<code>are not numeric, the column containing the m/z values can be specified with</code>matchValues<code>' parameter </code>mzColname<code>(defaults to</code>"mz"`).</p></li>
<li><p><code>Mz2MassRtParam</code>: same as <code>Mz2MassParam</code> but with additional comparison of
retention times between <code>query</code> and <code>target</code>. Parameters <code>rtColname</code> and
<code>mzColname</code> of <code>matchValues</code> allow to specify which columns contain the
retention times and m/z values, respectively.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ValueParam</span><span class="op">(</span>tolerance <span class="op">=</span> <span class="fl">0</span>, ppm <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MzParam</span><span class="op">(</span>tolerance <span class="op">=</span> <span class="fl">0</span>, ppm <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Mass2MzParam</span><span class="op">(</span>adducts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[M+H]+"</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0</span>, ppm <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Mass2MzRtParam</span><span class="op">(</span>adducts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[M+H]+"</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0</span>, ppm <span class="op">=</span> <span class="fl">5</span>, toleranceRt <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MzRtParam</span><span class="op">(</span>tolerance <span class="op">=</span> <span class="fl">0</span>, ppm <span class="op">=</span> <span class="fl">0</span>, toleranceRt <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Mz2MassParam</span><span class="op">(</span></span>
<span>  queryAdducts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[M+H]+"</span><span class="op">)</span>,</span>
<span>  targetAdducts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[M-H]-"</span><span class="op">)</span>,</span>
<span>  tolerance <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  ppm <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Mz2MassRtParam</span><span class="op">(</span></span>
<span>  queryAdducts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[M+H]+"</span><span class="op">)</span>,</span>
<span>  targetAdducts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[M+H]+"</span><span class="op">)</span>,</span>
<span>  tolerance <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  ppm <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  toleranceRt <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">matchValues</span><span class="op">(</span><span class="va">query</span>, <span class="va">target</span>, <span class="va">param</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for numeric,numeric,ValueParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span><span class="va">query</span>, <span class="va">target</span>, <span class="va">param</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for numeric,data.frameOrSimilar,ValueParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span></span>
<span>  <span class="va">query</span>,</span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">param</span>,</span>
<span>  valueColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  targetAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for data.frameOrSimilar,numeric,ValueParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span></span>
<span>  <span class="va">query</span>,</span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">param</span>,</span>
<span>  valueColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  queryAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for data.frameOrSimilar,data.frameOrSimilar,ValueParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span></span>
<span>  <span class="va">query</span>,</span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">param</span>,</span>
<span>  valueColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  queryAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  targetAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for numeric,numeric,Mass2MzParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span><span class="va">query</span>, <span class="va">target</span>, <span class="va">param</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for numeric,data.frameOrSimilar,Mass2MzParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span></span>
<span>  <span class="va">query</span>,</span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">param</span>,</span>
<span>  massColname <span class="op">=</span> <span class="st">"exactmass"</span>,</span>
<span>  targetAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for data.frameOrSimilar,numeric,Mass2MzParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span><span class="va">query</span>, <span class="va">target</span>, <span class="va">param</span>, mzColname <span class="op">=</span> <span class="st">"mz"</span>, queryAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for data.frameOrSimilar,data.frameOrSimilar,Mass2MzParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span></span>
<span>  <span class="va">query</span>,</span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">param</span>,</span>
<span>  mzColname <span class="op">=</span> <span class="st">"mz"</span>,</span>
<span>  massColname <span class="op">=</span> <span class="st">"exactmass"</span>,</span>
<span>  queryAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  targetAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for numeric,data.frameOrSimilar,MzParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span><span class="va">query</span>, <span class="va">target</span>, <span class="va">param</span>, mzColname <span class="op">=</span> <span class="st">"mz"</span>, targetAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for numeric,Spectra,MzParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span><span class="va">query</span>, <span class="va">target</span>, <span class="va">param</span>, mzColname <span class="op">=</span> <span class="st">"mz"</span>, targetAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for data.frameOrSimilar,numeric,MzParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span><span class="va">query</span>, <span class="va">target</span>, <span class="va">param</span>, mzColname <span class="op">=</span> <span class="st">"mz"</span>, queryAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for data.frameOrSimilar,data.frameOrSimilar,MzParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span></span>
<span>  <span class="va">query</span>,</span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">param</span>,</span>
<span>  mzColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mz"</span>, <span class="st">"mz"</span><span class="op">)</span>,</span>
<span>  queryAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  targetAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for data.frameOrSimilar,Spectra,MzParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span></span>
<span>  <span class="va">query</span>,</span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">param</span>,</span>
<span>  mzColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mz"</span>, <span class="st">"mz"</span><span class="op">)</span>,</span>
<span>  queryAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  targetAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for data.frameOrSimilar,data.frameOrSimilar,Mass2MzRtParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span></span>
<span>  <span class="va">query</span>,</span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">param</span>,</span>
<span>  massColname <span class="op">=</span> <span class="st">"exactmass"</span>,</span>
<span>  mzColname <span class="op">=</span> <span class="st">"mz"</span>,</span>
<span>  rtColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rt"</span>, <span class="st">"rt"</span><span class="op">)</span>,</span>
<span>  queryAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  targetAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for data.frameOrSimilar,data.frameOrSimilar,MzRtParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span></span>
<span>  <span class="va">query</span>,</span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">param</span>,</span>
<span>  mzColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mz"</span>, <span class="st">"mz"</span><span class="op">)</span>,</span>
<span>  rtColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rt"</span>, <span class="st">"rt"</span><span class="op">)</span>,</span>
<span>  queryAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  targetAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for data.frameOrSimilar,Spectra,MzRtParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span></span>
<span>  <span class="va">query</span>,</span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">param</span>,</span>
<span>  mzColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mz"</span>, <span class="st">"mz"</span><span class="op">)</span>,</span>
<span>  rtColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rt"</span>, <span class="st">"rt"</span><span class="op">)</span>,</span>
<span>  queryAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  targetAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for numeric,numeric,Mz2MassParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span><span class="va">query</span>, <span class="va">target</span>, <span class="va">param</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for numeric,data.frameOrSimilar,Mz2MassParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span><span class="va">query</span>, <span class="va">target</span>, <span class="va">param</span>, mzColname <span class="op">=</span> <span class="st">"mz"</span>, targetAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for data.frameOrSimilar,numeric,Mz2MassParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span><span class="va">query</span>, <span class="va">target</span>, <span class="va">param</span>, mzColname <span class="op">=</span> <span class="st">"mz"</span>, queryAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for data.frameOrSimilar,data.frameOrSimilar,Mz2MassParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span></span>
<span>  <span class="va">query</span>,</span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">param</span>,</span>
<span>  mzColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mz"</span>, <span class="st">"mz"</span><span class="op">)</span>,</span>
<span>  queryAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  targetAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for data.frameOrSimilar,data.frameOrSimilar,Mz2MassRtParam</span></span>
<span><span class="fu">matchValues</span><span class="op">(</span></span>
<span>  <span class="va">query</span>,</span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">param</span>,</span>
<span>  mzColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mz"</span>, <span class="st">"mz"</span><span class="op">)</span>,</span>
<span>  rtColname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rt"</span>, <span class="st">"rt"</span><span class="op">)</span>,</span>
<span>  queryAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  targetAssay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>tolerance</dt>
<dd><p>for any <code>param</code> object: <code>numeric(1)</code> defining the maximal
acceptable absolute difference in m/z (or in mass for <code>Mz2MassParam</code>)
to consider them <em>matching</em>.</p></dd>


<dt>ppm</dt>
<dd><p>for any <code>param</code> object: <code>numeric(1)</code> defining the maximal
acceptable m/z-dependent (or mass-dependent for <code>Mz2MassParam</code>)
difference (in parts-per-million) in m/z values to consider them to
be <em>matching</em>.</p></dd>


<dt>adducts</dt>
<dd><p>for <code>Mass2MzParam</code> or <code>Mass2MzRtParam</code>: either <code>character</code>
with adduct names from <code><a href="https://rdrr.io/pkg/MetaboCoreUtils/man/adductNames.html" class="external-link">MetaboCoreUtils::adducts()</a></code> or <code>data.frame</code> with
a custom adduct definition. This parameter is used to calculate m/z from
target compounds' masses. Custom adduct definitions can be passed to the
adduct parameter in form of a <code>data.frame</code>. This <code>data.frame</code> is expected
to have columns <code>"mass_add"</code> and <code>"mass_multi"</code> defining the <em>additive</em>
and <em>multiplicative</em> part of the calculation. See
<code><a href="https://rdrr.io/pkg/MetaboCoreUtils/man/adductNames.html" class="external-link">MetaboCoreUtils::adducts()</a></code> for the expected format or use
<code>MetaboCoreUtils::adductNames("positive")</code> and
<code>MetaboCoreUtils::adductNames("negative")</code> for valid adduct names.</p></dd>


<dt>toleranceRt</dt>
<dd><p>for <code>Mass2MzRtParam</code> or <code>MzRtParam</code>: <code>numeric(1)</code>
defining the maximal acceptable absolute difference in retention time
values to consider them them <em>matching</em>.</p></dd>


<dt>queryAdducts</dt>
<dd><p>for <code>Mz2MassParam</code>. Adducts used to derive mass
values from query m/z values. The expected format is the same as that
for parameter <code>adducts</code>.</p></dd>


<dt>targetAdducts</dt>
<dd><p>for <code>Mz2MassParam</code>. Adducts used to derive mass
values from target m/z values. The expected format is the same as that
for parameter <code>adducts</code>.</p></dd>


<dt>query</dt>
<dd><p>feature table containing information on MS1 features. Can be
a <code>numeric</code>, <code>data.frame</code>, <code>DataFrame</code>, <code>matrix</code>, <code>SummarizedExperiment</code>
or <code>QFeatures</code>. It is expected to contain m/z values and can contain also
other variables. Matchings based on both m/z and retention time can be
performed when a column with retention times is present in both <code>query</code>
and <code>target</code>.</p></dd>


<dt>target</dt>
<dd><p>compound table with metabolites to compare against. The
expected types are the same as those for <code>query</code>.</p></dd>


<dt>param</dt>
<dd><p>parameter object defining the matching approach and containing
the settings for that approach. See description above for details.</p></dd>


<dt>...</dt>
<dd><p>currently ignored.</p></dd>


<dt>valueColname</dt>
<dd><p><code>character</code> specifying the name of the column in
<code>query</code> or/and the one in <code>target</code>with the desired values for the
matching. This parameter should only be used when <code>param</code> is
<code>valueParam</code> and in this case it must be provided (unless both <code>query</code>
and <code>target</code> are <code>numeric</code>). It can be <code>character(1)</code> or <code>character(2)</code>
in a similar way to <code>mzColname</code>.</p></dd>


<dt>targetAssay</dt>
<dd><p><code>character(1)</code> specifying the name of the assay of the
provided <code>QFeatures</code> that should be used for the matching (values from
this assay's <code>rowData</code> will be used for matching). Only used if <code>target</code>
is an instance of a <code>QFeatures</code> object.</p></dd>


<dt>queryAssay</dt>
<dd><p><code>character(1)</code> specifying the name of the assay of the
provided <code>QFeatures</code> that should be used for the matching (values from
this assay's <code>rowData</code> will be used for matching). Only used if <code>query</code>
is an instance of a <code>QFeatures</code> object.</p></dd>


<dt>massColname</dt>
<dd><p><code>character(1)</code> with the name of the column in <code>target</code>
containing the mass of compounds. To be used when <code>param</code> is
<code>Mass2MzParam</code> or <code>Mass2MzRtParam</code> (and target is not already <code>numeric</code>
with the masses). Defaults to <code>massColname = "exactmass"</code>.</p></dd>


<dt>mzColname</dt>
<dd><p><code>character</code> specifying the name(s) of the column(s) in
<code>query</code> or/and <code>target</code>with the m/z values. If one among <code>query</code> and
<code>target</code> is <code>numeric</code> (and therefore there is no need to specify the
column name) or <code>query</code> is not <code>numeric</code> and <code>param</code> is <code>Mass2MzParam</code>
or <code>Mass2MzRtParam</code> (and therefore the name of the column with m/z needs
only to be specified for <code>query</code>) then <code>mzColname</code> is expected to be
<code>character(1)</code>. If both <code>query</code> and <code>target</code> are not numeric <code>mzColname</code>
is expected to be <code>character(2)</code> (or <code>character(1)</code> and in this last case
the two column names are assumed to be the same). If not specified the
assumed default name for columns with m/z values is <code>"mz"</code>. If <code>target</code>
is a <code><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra()</a></code> object, the name of the spectra variable that should be
used for the matching needs to be specified with <code>mzColname</code>.</p></dd>


<dt>rtColname</dt>
<dd><p><code>character(2)</code> with the name of the column containing
the compounds retention times in <code>query</code> and the name for the one in
<code>target</code>. It can also be <code>character(1)</code> if the two names are the same.
To be used when <code>param</code> is <code>MzRtParam</code> or <code>Mass2MzRtParam</code>.
Defaults to <code>rtColname = c("rt", "rt")</code>. If <code>target</code> is a <code><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra()</a></code>
object, the name of the spectra variable that should be used for the
matching needs to be specified with <code>mzColname</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><a href="Matched.html">Matched</a> object representing the result.</p>


<p>Depending on the <code>param</code> object different <em>scores</em> representing the quality
of the match are provided. This comprises absolute as well as relative
differences (column/variables <code>"score"</code> and <code>"ppm_error"</code> respectively).
If <code>param</code> is a <code>Mz2MassParam</code>, <code>"score"</code> and <code>"ppm_error"</code> represent
differences of the compared masses (calculated from the provided m/z values).
If <code>param</code> an <code>MzParam</code>, <code>MzRtParam</code>, <code>Mass2MzParam</code> or <code>Mass2MzRtParam</code>,
<code>"score"</code> and <code>"ppm_error"</code> represent absolute and relative differences of
m/z values.
Additionally, if <code>param</code> is either an <code>MzRtParam</code> or <code>Mass2MzRtParam</code></p>


<p>differences between query and target retention times for each matched
element is available in the column/variable <code>"score_rt"</code> in the returned
<code>Matched</code> object.
Negative values of <code>"score"</code> (or <code>"score_rt"</code>) indicate that the m/z or mass
(or retention time) of the query element is smaller than that of the target
element.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="matchSpectra.html">matchSpectra</a> or <code><a href="CompareSpectraParam.html">CompareSpectraParam()</a></code> for spectra data matching</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Andrea Vicini, Michael Witting</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/MetaboCoreUtils" class="external-link">MetaboCoreUtils</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘MetaboCoreUtils’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:CompoundDb’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     mass2mz</span>
<span class="r-in"><span><span class="co">## Create a simple "target/reference" compound table</span></span></span>
<span class="r-in"><span><span class="va">target_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tryptophan"</span>, <span class="st">"Leucine"</span>, <span class="st">"Isoleucine"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C11H12N2O2"</span>, <span class="st">"C6H13NO2"</span>, <span class="st">"C6H13NO2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   exactmass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">204.089878</span>, <span class="fl">131.094629</span>, <span class="fl">131.094629</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create a "feature" table with m/z of features. We calculate m/z for</span></span></span>
<span class="r-in"><span><span class="co">## certain adducts of some of the compounds in the reference table.</span></span></span>
<span class="r-in"><span><span class="va">fts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    feature_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FT001"</span>, <span class="st">"FT002"</span>, <span class="st">"FT003"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    mz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/MetaboCoreUtils/man/mass2mz.html" class="external-link">mass2mz</a></span><span class="op">(</span><span class="fl">204.089878</span>, <span class="st">"[M+H]+"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="fu"><a href="https://rdrr.io/pkg/MetaboCoreUtils/man/mass2mz.html" class="external-link">mass2mz</a></span><span class="op">(</span><span class="fl">131.094629</span>, <span class="st">"[M+H]+"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="fu"><a href="https://rdrr.io/pkg/MetaboCoreUtils/man/mass2mz.html" class="external-link">mass2mz</a></span><span class="op">(</span><span class="fl">204.089878</span>, <span class="st">"[M+Na]+"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1e-6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Define the parameters for the matching</span></span></span>
<span class="r-in"><span><span class="va">parm</span> <span class="op">&lt;-</span> <span class="fu">Mass2MzParam</span><span class="op">(</span></span></span>
<span class="r-in"><span>    adducts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[M+H]+"</span>, <span class="st">"[M+Na]+"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    tolerance <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    ppm <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">matchValues</span><span class="op">(</span><span class="va">fts</span>, <span class="va">target_df</span>, <span class="va">parm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class Matched </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of matches: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of query objects: 3 (3 matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of target objects: 3 (3 matched)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## List the available variables/columns</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "feature_id"       "mz"               "target_name"      "target_formula"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "target_exactmass" "adduct"           "score"            "ppm_error"       </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## feature_id and mz are from the query data frame, while target_name,</span></span></span>
<span class="r-in"><span><span class="co">## target_formula and target_exactmass are from the query object (columns</span></span></span>
<span class="r-in"><span><span class="co">## from the target object have a prefix *target_* added to the original</span></span></span>
<span class="r-in"><span><span class="co">## column name. Columns adduct, score and ppm_error represent the results</span></span></span>
<span class="r-in"><span><span class="co">## of the matching: adduct the adduct/ion of the original compound for which</span></span></span>
<span class="r-in"><span><span class="co">## the m/z matches, score the absolute difference of the query and target</span></span></span>
<span class="r-in"><span><span class="co">## m/z and ppm_error the relative difference in m/z values.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get the full matching result:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="Matched.html">matchedData</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 4 rows and 8 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      feature_id        mz target_name target_formula target_exactmass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;character&gt; &lt;numeric&gt; &lt;character&gt;    &lt;character&gt;        &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         FT001   205.097  Tryptophan     C11H12N2O2          204.090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         FT002   132.102     Leucine       C6H13NO2          131.095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.1       FT002   132.102  Isoleucine       C6H13NO2          131.095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         FT003   227.079  Tryptophan     C11H12N2O2          204.090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          adduct     score  ppm_error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;character&gt; &lt;numeric&gt;  &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        [M+H]+     0e+00 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        [M+H]+     0e+00 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.1      [M+H]+     0e+00 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       [M+Na]+     1e-06 0.00440375</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We have thus matches of FT002 to two different compounds (but with the</span></span></span>
<span class="r-in"><span><span class="co">## same mass).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Individual columns can also be accessed with the $ operator:</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">feature_id</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "FT001" "FT002" "FT002" "FT003"</span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">target_name</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Tryptophan" "Leucine"    "Isoleucine" "Tryptophan"</span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">ppm_error</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.000000000 0.000000000 0.000000000 0.004403752</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We repeat the matching requiring an exact match</span></span></span>
<span class="r-in"><span><span class="va">parm</span> <span class="op">&lt;-</span> <span class="fu">Mass2MzParam</span><span class="op">(</span></span></span>
<span class="r-in"><span>    adducts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[M+H]+"</span>, <span class="st">"[M+Na]+"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    tolerance <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    ppm <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">matchValues</span><span class="op">(</span><span class="va">fts</span>, <span class="va">target_df</span>, <span class="va">parm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class Matched </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of matches: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of query objects: 3 (2 matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of target objects: 3 (3 matched)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="Matched.html">matchedData</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 4 rows and 8 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      feature_id        mz target_name target_formula target_exactmass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;character&gt; &lt;numeric&gt; &lt;character&gt;    &lt;character&gt;        &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         FT001   205.097  Tryptophan     C11H12N2O2          204.090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         FT002   132.102     Leucine       C6H13NO2          131.095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.1       FT002   132.102  Isoleucine       C6H13NO2          131.095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         FT003   227.079          NA             NA               NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          adduct     score ppm_error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        [M+H]+         0         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        [M+H]+         0         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.1      [M+H]+         0         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3            NA        NA        NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The last feature could thus not be matched to any compound.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## At last we use also different adduct definitions.</span></span></span>
<span class="r-in"><span><span class="va">parm</span> <span class="op">&lt;-</span> <span class="fu">Mass2MzParam</span><span class="op">(</span></span></span>
<span class="r-in"><span>    adducts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[M+K]+"</span>, <span class="st">"[M+Li]+"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    tolerance <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    ppm <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">matchValues</span><span class="op">(</span><span class="va">fts</span>, <span class="va">target_df</span>, <span class="va">parm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class Matched </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of matches: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of query objects: 3 (0 matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of target objects: 3 (0 matched)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="Matched.html">matchedData</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 3 rows and 8 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    feature_id        mz target_name target_formula target_exactmass      adduct</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;character&gt; &lt;numeric&gt; &lt;character&gt;    &lt;character&gt;        &lt;numeric&gt; &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       FT001   205.097          NA             NA               NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       FT002   132.102          NA             NA               NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       FT003   227.079          NA             NA               NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       score ppm_error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;numeric&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        NA        NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## No matches were found.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We can also match a "feature" table with a target data.frame taking into</span></span></span>
<span class="r-in"><span><span class="co">## account both m/z and retention time values.</span></span></span>
<span class="r-in"><span><span class="va">target_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tryptophan"</span>, <span class="st">"Leucine"</span>, <span class="st">"Isoleucine"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C11H12N2O2"</span>, <span class="st">"C6H13NO2"</span>, <span class="st">"C6H13NO2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  exactmass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">204.089878</span>, <span class="fl">131.094629</span>, <span class="fl">131.094629</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  rt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">150</span>, <span class="fl">140</span>, <span class="fl">140</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  feature_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FT001"</span>, <span class="st">"FT002"</span>, <span class="st">"FT003"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  mz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/MetaboCoreUtils/man/mass2mz.html" class="external-link">mass2mz</a></span><span class="op">(</span><span class="fl">204.089878</span>, <span class="st">"[M+H]+"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fu"><a href="https://rdrr.io/pkg/MetaboCoreUtils/man/mass2mz.html" class="external-link">mass2mz</a></span><span class="op">(</span><span class="fl">131.094629</span>, <span class="st">"[M+H]+"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fu"><a href="https://rdrr.io/pkg/MetaboCoreUtils/man/mass2mz.html" class="external-link">mass2mz</a></span><span class="op">(</span><span class="fl">204.089878</span>, <span class="st">"[M+Na]+"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1e-6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  rt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">150</span>, <span class="fl">140</span>, <span class="fl">150.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Define the parameters for the matching</span></span></span>
<span class="r-in"><span><span class="va">parm</span> <span class="op">&lt;-</span> <span class="fu">Mass2MzRtParam</span><span class="op">(</span></span></span>
<span class="r-in"><span>  adducts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[M+H]+"</span>, <span class="st">"[M+Na]+"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  tolerance <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  ppm <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  toleranceRt <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">matchValues</span><span class="op">(</span><span class="va">fts</span>, <span class="va">target_df</span>, <span class="va">parm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class Matched </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of matches: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of query objects: 3 (2 matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of target objects: 3 (3 matched)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get the full matching result:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="Matched.html">matchedData</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 4 rows and 11 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      feature_id        mz        rt target_name target_formula target_exactmass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;character&gt;    &lt;character&gt;        &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         FT001   205.097     150.0  Tryptophan     C11H12N2O2          204.090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         FT002   132.102     140.0     Leucine       C6H13NO2          131.095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.1       FT002   132.102     140.0  Isoleucine       C6H13NO2          131.095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         FT003   227.079     150.1          NA             NA               NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     target_rt      adduct     score ppm_error  score_rt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;numeric&gt; &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         150      [M+H]+         0         0         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         140      [M+H]+         0         0         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.1       140      [M+H]+         0         0         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          NA          NA        NA        NA        NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## FT003 could not be matched to any compound, FT002 was matched to two</span></span></span>
<span class="r-in"><span><span class="co">## different compounds (but with the same mass).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We repeat the matching allowing a positive tolerance for the matches</span></span></span>
<span class="r-in"><span><span class="co">## between rt values</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Define the parameters for the matching</span></span></span>
<span class="r-in"><span><span class="va">parm</span> <span class="op">&lt;-</span> <span class="fu">Mass2MzRtParam</span><span class="op">(</span></span></span>
<span class="r-in"><span>  adducts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[M+H]+"</span>, <span class="st">"[M+Na]+"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  tolerance <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  ppm <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  toleranceRt <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">matchValues</span><span class="op">(</span><span class="va">fts</span>, <span class="va">target_df</span>, <span class="va">parm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class Matched </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of matches: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of query objects: 3 (3 matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of target objects: 3 (3 matched)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get the full matching result:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="Matched.html">matchedData</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 4 rows and 11 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      feature_id        mz        rt target_name target_formula target_exactmass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;character&gt;    &lt;character&gt;        &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         FT001   205.097     150.0  Tryptophan     C11H12N2O2          204.090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         FT002   132.102     140.0     Leucine       C6H13NO2          131.095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.1       FT002   132.102     140.0  Isoleucine       C6H13NO2          131.095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         FT003   227.079     150.1  Tryptophan     C11H12N2O2          204.090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     target_rt      adduct     score  ppm_error  score_rt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;numeric&gt; &lt;character&gt; &lt;numeric&gt;  &lt;numeric&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         150      [M+H]+     0e+00 0.00000000       0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         140      [M+H]+     0e+00 0.00000000       0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.1       140      [M+H]+     0e+00 0.00000000       0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         150     [M+Na]+     1e-06 0.00440375       0.1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Also FT003 was matched in this case</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## It is also possible to match directly m/z values</span></span></span>
<span class="r-in"><span><span class="va">mz1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">343</span>, <span class="fl">23</span>, <span class="fl">231</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mz2</span> <span class="op">&lt;-</span> <span class="va">mz1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4</span>, sd <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">matchValues</span><span class="op">(</span><span class="va">mz1</span>, <span class="va">mz2</span>, <span class="fu">MzParam</span><span class="op">(</span>tolerance <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="Matched.html">matchedData</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 4 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    query   target        score ppm_error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;AsIs&gt;   &lt;AsIs&gt;    &lt;numeric&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     12  11.9999  0.000108966  9.080580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    343 342.9999  0.000117242  0.341813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     23  23.0002 -0.000183083  7.960050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    231 231.0013 -0.001280555  5.543497</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Matching with a SummarizedExperiment or a QFeatures work analogously,</span></span></span>
<span class="r-in"><span><span class="co">## only that the matching is performed on the object's `rowData`.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Below we create a simple SummarizedExperiment with some random assay data.</span></span></span>
<span class="r-in"><span><span class="co">## Note that results from a data preprocessing with the `xcms` package could</span></span></span>
<span class="r-in"><span><span class="co">## be extracted as a `SummarizedExperiment` with the `quantify` method from</span></span></span>
<span class="r-in"><span><span class="co">## the `xcms` package.</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    assays <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>    dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    rowData <span class="op">=</span> <span class="va">fts</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We can now perform the matching of this SummarizedExperiment against the</span></span></span>
<span class="r-in"><span><span class="co">## target_df as before.</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">matchValues</span><span class="op">(</span><span class="va">se</span>, <span class="va">target_df</span>,</span></span>
<span class="r-in"><span>    param <span class="op">=</span> <span class="fu">Mass2MzParam</span><span class="op">(</span>adducts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[M+H]+"</span>, <span class="st">"[M+Na]+"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        tolerance <span class="op">=</span> <span class="fl">0</span>, ppm <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class Matched </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of matches: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of query objects: 3 (3 matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of target objects: 3 (3 matched)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Getting the available columns</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "feature_id"       "mz"               "rt"               "target_name"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "target_formula"   "target_exactmass" "target_rt"        "adduct"          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "score"            "ppm_error"       </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The query columns represent the columns of the object's `rowData`</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 3 rows and 3 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    feature_id        mz        rt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       FT001   205.097     150.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       FT002   132.102     140.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       FT003   227.079     150.1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## matchedData also returns the query object's rowData along with the</span></span></span>
<span class="r-in"><span><span class="co">## matching entries in the target object.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="Matched.html">matchedData</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 4 rows and 10 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    feature_id        mz        rt target_name target_formula target_exactmass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;character&gt;    &lt;character&gt;        &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       FT001   205.097     150.0  Tryptophan     C11H12N2O2          204.090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       FT002   132.102     140.0     Leucine       C6H13NO2          131.095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       FT002   132.102     140.0  Isoleucine       C6H13NO2          131.095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       FT003   227.079     150.1  Tryptophan     C11H12N2O2          204.090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   target_rt      adduct     score  ppm_error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;numeric&gt; &lt;character&gt; &lt;numeric&gt;  &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       150      [M+H]+     0e+00 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       140      [M+H]+     0e+00 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       140      [M+H]+     0e+00 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       150     [M+Na]+     1e-06 0.00440375</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## While `query` will return the full SummarizedExperiment.</span></span></span>
<span class="r-in"><span><span class="fu">query</span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class: SummarizedExperiment </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dim: 3 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> metadata(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assays(1): ''</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rownames: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rowData names(3): feature_id mz rt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colnames(4): A B C D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colData names(0):</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## To illustrate use with a QFeatures object we first create a simple</span></span></span>
<span class="r-in"><span><span class="co">## QFeatures object with two assays, `"ions"` representing the full feature</span></span></span>
<span class="r-in"><span><span class="co">## data.frame and `"compounds"` a subset of it.</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/QFeatures" class="external-link">QFeatures</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: MultiAssayExperiment</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘QFeatures’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:MultiAssayExperiment’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     longFormat</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     sweep</span>
<span class="r-in"><span><span class="va">qf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-class.html" class="external-link">QFeatures</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ions <span class="op">=</span> <span class="va">se</span>, compounds <span class="op">=</span> <span class="va">se</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We can perform the same matching as before, but need to specify which of</span></span></span>
<span class="r-in"><span><span class="co">## the assays in the QFeatures should be used for the matching. Below we</span></span></span>
<span class="r-in"><span><span class="co">## perform the matching using the "ions" assay.</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">matchValues</span><span class="op">(</span><span class="va">qf</span>, <span class="va">target_df</span>, queryAssay <span class="op">=</span> <span class="st">"ions"</span>,</span></span>
<span class="r-in"><span>    param <span class="op">=</span> <span class="fu">Mass2MzParam</span><span class="op">(</span>adducts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[M+H]+"</span>, <span class="st">"[M+Na]+"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        tolerance <span class="op">=</span> <span class="fl">0</span>, ppm <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class Matched </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of matches: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of query objects: 3 (3 matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of target objects: 3 (3 matched)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## colnames returns now the colnames of the `rowData` of the `"ions"` assay.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "feature_id"       "mz"               "rt"               "target_name"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "target_formula"   "target_exactmass" "target_rt"        "adduct"          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "score"            "ppm_error"       </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="Matched.html">matchedData</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 4 rows and 10 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    feature_id        mz        rt target_name target_formula target_exactmass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;character&gt;    &lt;character&gt;        &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       FT001   205.097     150.0  Tryptophan     C11H12N2O2          204.090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       FT002   132.102     140.0     Leucine       C6H13NO2          131.095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       FT002   132.102     140.0  Isoleucine       C6H13NO2          131.095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       FT003   227.079     150.1  Tryptophan     C11H12N2O2          204.090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   target_rt      adduct     score  ppm_error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;numeric&gt; &lt;character&gt; &lt;numeric&gt;  &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       150      [M+H]+     0e+00 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       140      [M+H]+     0e+00 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       140      [M+H]+     0e+00 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       150     [M+Na]+     1e-06 0.00440375</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Witting, Johannes Rainer, Andrea Vicini, Carolin Huber, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

